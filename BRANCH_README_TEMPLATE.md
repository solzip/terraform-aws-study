# 01-basic - Terraform ê¸°ì´ˆ

> ðŸŸ¢ **ë‚œì´ë„**: ì´ˆê¸‰ | **í•™ìŠµ ì‹œê°„**: 2-3ì‹œê°„

[â† ë©”ì¸ READMEë¡œ ëŒì•„ê°€ê¸°](../../)

## ðŸ“š ì´ ë¸Œëžœì¹˜ì—ì„œ ë°°ìš°ëŠ” ê²ƒ

ì´ ë¸Œëžœì¹˜ëŠ” Terraformì˜ ê°€ìž¥ ê¸°ë³¸ì ì¸ ê°œë…ê³¼ AWS ì¸í”„ë¼ êµ¬ì¶• ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.

### í•™ìŠµ ëª©í‘œ
- âœ… Terraform ê¸°ë³¸ ë¬¸ë²• (HCL) ì´í•´
- âœ… Provider ì„¤ì • ë°©ë²•
- âœ… ê¸°ë³¸ ë¦¬ì†ŒìŠ¤ ìƒì„± (VPC, EC2, Security Group)
- âœ… Variablesì™€ Outputs í™œìš©
- âœ… State íŒŒì¼ì˜ ì—­í•  ì´í•´
- âœ… Terraform ì›Œí¬í”Œë¡œìš° (init â†’ plan â†’ apply â†’ destroy)

## ðŸ—ï¸ ìƒì„±ë˜ëŠ” AWS ë¦¬ì†ŒìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           VPC (10.0.0.0/16)            â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Public Subnet (10.0.1.0/24)     â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  EC2 Instance (t2.micro)    â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - Amazon Linux 2023        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  - Apache Web Server        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚  Security Group                   â”‚ â”‚
â”‚  â”‚  - Port 80 (HTTP)                 â”‚ â”‚
â”‚  â”‚  - Port 22 (SSH)                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  Internet Gateway                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë¦¬ì†ŒìŠ¤ ëª©ë¡
1. **VPC** - ê²©ë¦¬ëœ ë„¤íŠ¸ì›Œí¬ ê³µê°„
2. **Internet Gateway** - ì¸í„°ë„· ì—°ê²°
3. **Public Subnet** - í¼ë¸”ë¦­ ì ‘ê·¼ ê°€ëŠ¥í•œ ì„œë¸Œë„·
4. **Route Table** - ë„¤íŠ¸ì›Œí¬ ë¼ìš°íŒ…
5. **Security Group** - ë°©í™”ë²½ ê·œì¹™
6. **EC2 Instance** - ê°€ìƒ ì„œë²„

## ðŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
01-basic/
â”œâ”€â”€ docs/                      # ë¬¸ì„œ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ 01-setup.md           # ì´ˆê¸° ì„¤ì • ê°€ì´ë“œ
â”‚   â”œâ”€â”€ 02-execution.md       # ì‹¤í–‰ ê°€ì´ë“œ
â”‚   â””â”€â”€ 03-cleanup.md         # ì •ë¦¬ ê°€ì´ë“œ
â”œâ”€â”€ main.tf                   # ì£¼ìš” ë¦¬ì†ŒìŠ¤ ì •ì˜
â”œâ”€â”€ variables.tf              # ìž…ë ¥ ë³€ìˆ˜ ì„ ì–¸
â”œâ”€â”€ outputs.tf                # ì¶œë ¥ ê°’ ì •ì˜
â”œâ”€â”€ versions.tf               # Terraform ë° Provider ë²„ì „
â”œâ”€â”€ terraform.tfvars.example  # ë³€ìˆ˜ ê°’ ì˜ˆì‹œ
â”œâ”€â”€ .gitignore               # Git ì œì™¸ íŒŒì¼
â””â”€â”€ README.md                # í˜„ìž¬ ë¬¸ì„œ
```

## ðŸš€ ì‹¤ìŠµ ì‹œìž‘í•˜ê¸°

### 1ë‹¨ê³„: ë¸Œëžœì¹˜ ì²´í¬ì•„ì›ƒ
```bash
git checkout 01-basic
```

### 2ë‹¨ê³„: ë³€ìˆ˜ íŒŒì¼ ì„¤ì •
```bash
# ì˜ˆì‹œ íŒŒì¼ ë³µì‚¬
cp terraform.tfvars.example terraform.tfvars

# ì—ë””í„°ë¡œ ì—´ì–´ì„œ ê°’ ìˆ˜ì •
vim terraform.tfvars
```

**terraform.tfvars ì˜ˆì‹œ**:
```hcl
aws_region         = "ap-northeast-2"
environment        = "dev"
project_name       = "my-terraform-project"
vpc_cidr           = "10.0.0.0/16"
public_subnet_cidr = "10.0.1.0/24"
instance_type      = "t2.micro"
```

### 3ë‹¨ê³„: Terraform ì´ˆê¸°í™”
```bash
terraform init
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
Initializing the backend...
Initializing provider plugins...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Installing hashicorp/aws v5.31.0...

Terraform has been successfully initialized!
```

### 4ë‹¨ê³„: ì‹¤í–‰ ê³„íš í™•ì¸
```bash
terraform plan
```

**í™•ì¸ ì‚¬í•­**:
- ìƒì„±ë  ë¦¬ì†ŒìŠ¤ ê°œìˆ˜: `Plan: 7 to add`
- ê° ë¦¬ì†ŒìŠ¤ì˜ ì†ì„±ê°’ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸

### 5ë‹¨ê³„: ì¸í”„ë¼ ë°°í¬
```bash
terraform apply
```

**í™•ì¸ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚˜ë©´ `yes` ìž…ë ¥**

ë°°í¬ ì™„ë£Œ í›„ ì¶œë ¥ê°’ í™•ì¸:
```
Outputs:

instance_id = "i-0123456789abcdef0"
instance_public_ip = "13.125.123.45"
vpc_id = "vpc-0123456789abcdef0"
web_url = "http://13.125.123.45"
```

### 6ë‹¨ê³„: ì›¹ ì„œë²„ ì ‘ì† í™•ì¸
```bash
# ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†
# http://[instance_public_ip]

# ë˜ëŠ” curlë¡œ í™•ì¸
curl $(terraform output -raw web_url)
```

### 7ë‹¨ê³„: ë¦¬ì†ŒìŠ¤ ì •ë¦¬
```bash
terraform destroy
```

**í™•ì¸ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚˜ë©´ `yes` ìž…ë ¥**

## ðŸ’¡ í•µì‹¬ í•™ìŠµ í¬ì¸íŠ¸

### 1. Terraform íŒŒì¼ êµ¬ì¡°

#### `versions.tf` - Provider ë²„ì „ ê´€ë¦¬
```hcl
terraform {
  required_version = ">= 1.0"
  
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"
    }
  }
}

provider "aws" {
  region = var.aws_region
}
```

**í•™ìŠµ í¬ì¸íŠ¸**:
- `required_version`: Terraform CLI ë²„ì „ ì§€ì •
- `required_providers`: ì‚¬ìš©í•  Providerì™€ ë²„ì „
- `provider` ë¸”ë¡: Provider ì„¤ì •

---

#### `variables.tf` - ë³€ìˆ˜ ì„ ì–¸
```hcl
variable "aws_region" {
  description = "AWS ë¦¬ì „"
  type        = string
  default     = "ap-northeast-2"
}

variable "instance_type" {
  description = "EC2 ì¸ìŠ¤í„´ìŠ¤ íƒ€ìž…"
  type        = string
  default     = "t2.micro"
  
  validation {
    condition     = contains(["t2.micro", "t2.small"], var.instance_type)
    error_message = "í”„ë¦¬í‹°ì–´ ì¸ìŠ¤í„´ìŠ¤ íƒ€ìž…ë§Œ í—ˆìš©ë©ë‹ˆë‹¤."
  }
}
```

**í•™ìŠµ í¬ì¸íŠ¸**:
- `description`: ë³€ìˆ˜ ì„¤ëª…
- `type`: ë°ì´í„° íƒ€ìž… (string, number, bool, list, map)
- `default`: ê¸°ë³¸ê°’
- `validation`: ìž…ë ¥ê°’ ê²€ì¦

---

#### `main.tf` - ë¦¬ì†ŒìŠ¤ ì •ì˜
```hcl
resource "aws_vpc" "main" {
  cidr_block           = var.vpc_cidr
  enable_dns_hostnames = true
  
  tags = {
    Name = "${var.project_name}-${var.environment}-vpc"
  }
}
```

**í•™ìŠµ í¬ì¸íŠ¸**:
- `resource "íƒ€ìž…" "ì´ë¦„"`: ë¦¬ì†ŒìŠ¤ ì„ ì–¸
- ë³€ìˆ˜ ì°¸ì¡°: `var.ë³€ìˆ˜ëª…`
- ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ ì°¸ì¡°: `aws_vpc.main.id`
- ë¬¸ìžì—´ ë³´ê°„: `"${var.name}-suffix"`

---

#### `outputs.tf` - ì¶œë ¥ê°’ ì •ì˜
```hcl
output "instance_public_ip" {
  description = "EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ Public IP"
  value       = aws_instance.web.public_ip
}
```

**í•™ìŠµ í¬ì¸íŠ¸**:
- ì¤‘ìš”í•œ ì •ë³´ë¥¼ ì‚¬ìš©ìžì—ê²Œ í‘œì‹œ
- ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì°¸ì¡° ê°€ëŠ¥
- `terraform output` ëª…ë ¹ìœ¼ë¡œ í™•ì¸

---

### 2. Terraform ì›Œí¬í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   init   â”‚  # Provider ë‹¤ìš´ë¡œë“œ, ì´ˆê¸°í™”
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   plan   â”‚  # ë³€ê²½ ì‚¬í•­ ë¯¸ë¦¬ë³´ê¸°
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  apply   â”‚  # ì‹¤ì œ ë¦¬ì†ŒìŠ¤ ìƒì„±/ë³€ê²½
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì‚¬ìš©    â”‚  # ì¸í”„ë¼ ì‚¬ìš©
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ destroy  â”‚  # ë¦¬ì†ŒìŠ¤ ì‚­ì œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. State íŒŒì¼ì˜ ì—­í• 

**terraform.tfstate**:
- í˜„ìž¬ ì¸í”„ë¼ì˜ ì‹¤ì œ ìƒíƒœ ì €ìž¥
- Terraformì´ ë³€ê²½ì‚¬í•­ì„ ì¶”ì í•˜ëŠ” ë°©ë²•
- íŒ€ í˜‘ì—… ì‹œ ê³µìœ  í•„ìš” (ë‹¤ìŒ ë¸Œëžœì¹˜ì—ì„œ í•™ìŠµ)

**âš ï¸ ì£¼ì˜**: State íŒŒì¼ì—ëŠ” ë¯¼ê°í•œ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìžˆìœ¼ë¯€ë¡œ Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!

## ðŸ“– ìƒì„¸ ê°€ì´ë“œ ë¬¸ì„œ

ë” ìžì„¸í•œ ë‚´ìš©ì€ ë‹¤ìŒ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”:

1. **[ì´ˆê¸° ì„¤ì • ê°€ì´ë“œ](docs/01-setup.md)**
    - Terraform ì„¤ì¹˜
    - AWS CLI ì„¤ì •
    - í”„ë¡œì íŠ¸ ì´ˆê¸°í™”

2. **[ì‹¤í–‰ ê°€ì´ë“œ](docs/02-execution.md)**
    - ëª…ë ¹ì–´ ìƒì„¸ ì„¤ëª…
    - íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
    - ìœ ìš©í•œ íŒ

3. **[ì •ë¦¬ ê°€ì´ë“œ](docs/03-cleanup.md)**
    - ë¦¬ì†ŒìŠ¤ ì‚­ì œ ë°©ë²•
    - ë¹„ìš© ë°©ì§€
    - ë¡œì»¬ íŒŒì¼ ì •ë¦¬

## ðŸ› ìžì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ

### ë¬¸ì œ 1: AWS ìžê²©ì¦ëª… ì˜¤ë¥˜
```
Error: error configuring Terraform AWS Provider: no valid credential sources
```

**í•´ê²°ë°©ë²•**:
```bash
aws configure
# Access Key IDì™€ Secret Access Key ìž…ë ¥
```

---

### ë¬¸ì œ 2: ë¦¬ì†ŒìŠ¤ ì´ë¦„ ì¤‘ë³µ
```
Error: InvalidVpcID.NotFound
```

**í•´ê²°ë°©ë²•**:
```bash
# State íŒŒì¼ì´ ìžˆëŠ”ì§€ í™•ì¸
ls -la terraform.tfstate*

# ìžˆë‹¤ë©´ ì‚­ì œ í›„ ìž¬ì‹œë„
rm terraform.tfstate*
terraform apply
```

---

### ë¬¸ì œ 3: Port 80 ì ‘ì† ì•ˆë¨
```bash
# Security Group í™•ì¸
terraform state show aws_security_group.web

# ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœ í™•ì¸
aws ec2 describe-instances --instance-ids $(terraform output -raw instance_id)
```

ë” ë§Žì€ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì€ [ì‹¤í–‰ ê°€ì´ë“œ](docs/02-execution.md)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

## ðŸ’° ë¹„ìš© ì•ˆë‚´

ì´ ë¸Œëžœì¹˜ì—ì„œ ìƒì„±í•˜ëŠ” ë¦¬ì†ŒìŠ¤ëŠ” ëª¨ë‘ **AWS í”„ë¦¬í‹°ì–´ ë¬´ë£Œ ë²”ìœ„** ë‚´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤:

- âœ… **t2.micro EC2**: 750ì‹œê°„/ì›” ë¬´ë£Œ
- âœ… **VPC, Subnet, IGW**: ë¬´ë£Œ
- âœ… **Data Transfer**: 15GB/ì›” ë¬´ë£Œ

**âš ï¸ ì¤‘ìš”**: ì‹¤ìŠµ í›„ ë°˜ë“œì‹œ `terraform destroy`ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•˜ì„¸ìš”!

## ðŸ“ í•™ìŠµ ë…¸íŠ¸ ìž‘ì„±

í•™ìŠµí•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ì„¸ìš”:

```bash
# ê°œì¸ í•™ìŠµ ë…¸íŠ¸ ìž‘ì„±
mkdir -p learning-notes
cat > learning-notes/01-basic-notes.md << EOF
# 01-basic í•™ìŠµ ì •ë¦¬

## ë°°ìš´ ë‚´ìš©
- ...

## ì–´ë ¤ì› ë˜ ì 
- ...

## ë‹¤ìŒì— ê³µë¶€í•  ê²ƒ
- ...
EOF
```

## âœ… í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì´ ë¸Œëžœì¹˜ë¥¼ ì™„ë£Œí–ˆë‹¤ë©´ ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] Terraform ê¸°ë³¸ ëª…ë ¹ì–´ ì´í•´ (init, plan, apply, destroy)
- [ ] HCL ë¬¸ë²• ì´í•´
- [ ] Variables ì„ ì–¸ ë° ì‚¬ìš©
- [ ] Outputs ì •ì˜ ë° í™œìš©
- [ ] AWS ë¦¬ì†ŒìŠ¤ ê°„ ì˜ì¡´ì„± ì´í•´
- [ ] State íŒŒì¼ì˜ ì—­í•  ì´í•´
- [ ] ì‹¤ì œ EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ì ‘ì† í™•ì¸
- [ ] ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì™„ë£Œ

## ðŸ”„ ë‹¤ìŒ ë‹¨ê³„

ì¶•í•˜í•©ë‹ˆë‹¤! Terraform ê¸°ì´ˆë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ðŸŽ‰

ë‹¤ìŒ ë¸Œëžœì¹˜ë¡œ ì´ë™í•˜ì—¬ í•™ìŠµì„ ê³„ì†í•˜ì„¸ìš”:

```bash
# ë¦¬ì†ŒìŠ¤ ì •ë¦¬ í›„
terraform destroy

# ë‹¤ìŒ ë¸Œëžœì¹˜ë¡œ ì´ë™
git checkout 02-basic-localstack
```

**ë‹¤ìŒ í•™ìŠµ ì£¼ì œ**: LocalStackì„ ì‚¬ìš©í•œ ë¡œì»¬ ê°œë°œ í™˜ê²½ êµ¬ì¶•

[â† ë©”ì¸ READMEë¡œ ëŒì•„ê°€ê¸°](../../) | [ë‹¤ìŒ: 02-basic-localstack â†’](../../tree/02-basic-localstack)

---

**ìž‘ì„±ì¼**: 2025-02-02  
**ë‚œì´ë„**: ðŸŸ¢ ì´ˆê¸‰  
**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 2-3ì‹œê°„